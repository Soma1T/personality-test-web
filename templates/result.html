max_matches = -1
best_match = None

for user_id, row in pivot_df.iterrows():
    matches = 0
    for q_id, ans in user_answers.items():
        if str(q_id) in row.index:
            db_answer = row[int(q_id)]
            if isinstance(db_answer, str) and isinstance(ans, str):
                if db_answer.strip().lower() == ans.strip().lower():
                    matches += 1
            elif db_answer == ans:
                matches += 1
    if matches > max_matches:
        max_matches = matches
        best_match = user_id